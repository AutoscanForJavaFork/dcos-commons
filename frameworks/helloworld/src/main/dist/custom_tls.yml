name: {{FRAMEWORK_NAME}}
scheduler:
  principal: {{FRAMEWORK_PRINCIPAL}}
pods:
  # Exposes custom artifacts in a container, no mount-path specified
  custom-no-mount-path:
    count: {{HELLO_COUNT}}
    uris:
      - {{JAVA_URI}}
      - {{BOOTSTRAP_URI}}
    tasks:
      node:
        goal: RUNNING
        cmd: >
                ./bootstrap -verbose -resolve=false

                ls -lah && cat custom-secret.pem && sleep $SLEEP_DURATION
        cpus: 0.1
        memory: 256
        env:
          SLEEP_DURATION: {{SLEEP_DURATION}}
        transport-encryption:
          - name: custom-secret.pem
            secret: hello-world/custom-secret
            type: CUSTOM

  # Exposes custom artifacts in a container, mount-path specified.
  custom-mount-path:
    count: {{HELLO_COUNT}}
    uris:
      - {{JAVA_URI}}
      - {{BOOTSTRAP_URI}}
    tasks:
      node:
        goal: RUNNING
        cmd: >
                ./bootstrap -verbose -resolve=false

                ls -lah && cat ssl/custom-secret.pem && sleep $SLEEP_DURATION
        cpus: 0.1
        memory: 256
        env:
          SLEEP_DURATION: {{SLEEP_DURATION}}
        transport-encryption:
          - name: custom-secret
            secret: hello-world/custom-secret
            mount-path: ssl/custom-secret.pem
            type: CUSTOM

plans:
  deploy:
    strategy: parallel
    phases:
      custom-no-mount-path:
        strategy: parallel
        pod: custom-no-mount-path
      custom-mount-path:
        strategy: parallel
        pod: custom-mount-path
